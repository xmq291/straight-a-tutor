define("AjaxUtils",["jquery",],function(n){var t={loaderId:"ajax-loading",sendData:function(t,i,r){t=t||{};var f=t.action,e=t.method,u,o=t.dataType!==undefined?t.dataType:"json",s=t.cache!==undefined?t.cache:!0,h=t.headers!==undefined?t.headers:"",c=t.sendCookies!==undefined,l=this;if(t!==undefined&&t.nodeName&&t.nodeName.toLowerCase()==="form")u=n(t).serialize();else if(t.action&&t.method&&t.data!==undefined)u=t.data;else return!1;return n.ajax({url:f,type:e,data:u,dataType:o,cache:s,headers:h,xhrFields:{withCredentials:c}}).done(function(n){typeof i=="function"&&i(n)}).fail(function(n,t,i){var u="",e;if(typeof r=="function"){try{u=JSON.parse(n.responseText)}catch(o){u=n.responseText}r({statusCode:n.status||-1,textStatus:t,errorThrown:i,data:u})}e=[n.status,n.statusText,];l.logError(e.join(", "),f)})},logError:function(n,t){var i={arguments:n,action:t};wyzant&&wyzant.logging&&wyzant.logging.eLogger&&typeof wyzant.logging.eLogger.logEvent=="function"&&wyzant.logging.eLogger.logEvent("JavaScriptAjaxError","An AJAX error has occurred",i)},showLoader:function(t,i){n(t).append("<div class='"+this.loaderId+"'><div class='"+i+"'><div class='cube cube-1'><\/div><div class='cube cube-2'><\/div><div class='cube cube-4'><\/div><div class='cube cube-3'><\/div><\/div><\/div>")},hideLoader:function(t){n(t).find("."+this.loaderId).remove()}};return{getJSON:function(i,r,u){var f={method:"get",dataType:"json"};return n.extend(f,i),t.sendData(f,r,u)},postJSON:function(i,r,u){var f={method:"post",dataType:"json"};return n.extend(f,i),t.sendData(f,r,u)},getPartial:function(i,r,u){var f={dataType:"html"};return n.extend(f,i),t.sendData(f,r,u)},replacePartial:function(n,t,i,r){return this.getPartial(n,function(n){t instanceof jQuery&&t.html(n);typeof i=="function"&&i(n)},r)},loadingOverlay:{$body:n("body"),overlayEl:null,overlayId:"pageLoadingOverlay",loaderClass:"wyz-loader wyz-loader-multi wyz-loader-large",getOverlay:function(){var t=this.overlayEl;return t===null&&(t=n("#"+this.overlayId),(t===null||t.length===0)&&(t=n("<div id='"+this.overlayId+"' class='ui-overlay ui-overlay-page'><\/div>")),this.overlayEl=t),this.overlayEl},show:function(){this.$body.append(this.getOverlay());t.showLoader(this.overlayEl,this.loaderClass)},hide:function(){this.getOverlay().remove();t.hideLoader(this.overlayEl)}},itemLoading:{loaderClass:"wyz-loader wyz-loader-multi wyz-loader-small",show:function(n){this.hide(n);t.showLoader(n,this.loaderClass)},hide:function(n){t.hideLoader(n)}},sectionLoading:{overlayClass:"ui-overlay",loaderClass:"wyz-loader wyz-loader-multi wyz-loader-large",show:function(i){n(i).addClass(this.overlayClass);t.showLoader(i,this.loaderClass)},hide:function(i){n(i).removeClass(this.overlayClass);t.hideLoader(i)}},logError:function(n,i){t.logError(n,i)},convertObjectToList:function(n,t){var i,r;if(!n||typeof n!="object")return!1;i="";for(r in n)i+="<li>"+n[r]+"<\/li>";return"<ul class='"+(t||"ajax-list")+"'>"+i+"<\/ul>"},displayModelStateErrors:function(t,i){var f=t.find("div[class*=validation-summary-]"),r=f.find("ul"),e,o,s,u,h;f.removeClass("validation-summary-valid").addClass("validation-summary-errors");r.length===0?(r=n("<ul><\/ul>"),f.append(r)):r.html("");for(e in i){for(o=i[e],s="",u=0,h=o.length;u<h;u++)s+="<li>"+o[u]+"<\/li>";r.append(s);n("[name="+e+"]").addClass("input-validation-error")}},displayGenericErrorBanner:function(){var t=n("<div id='ajaxErrorBanner' class='row'><div class='column spc-med-s'><div class='nfy nfy-error'>An error occurred, please try again.<\/div><\/div><\/div>");n("#masthead ~ .row").first().before(t);t.get(0).scrollIntoView();t.delay(2e3).fadeOut()}}});define("APIAjaxUtils",["jquery","AjaxUtils","Utils","Tracking","shared/jquery.wyzantModal",],function(n,t,i,r){var u={cachedBrowserSupportKey:"wyzAPIBrowserSupport_",cachedAPITokenKey:"wyzAPIToken",getBrowserSupport:function(i){var u=this,f="https://"+i+"/browsercheck",r=n.Deferred(),e=i.replace(/\./g,"_"),o=u.getStoredBrowserSupport(e);return o!==!0?(n.ajax({url:f,type:"GET",dataType:"JSON",cache:!1}).done(function(n,i,o){if(o.status===202)u.storeBrowserSupport(e,!0),r.resolve(!0);else{var s=["Browser check error, wrong status code: ",(n||"").toString(),o.status,o.statusText,];t.logError(s.join(", "),f);u.storeBrowserSupport(e,!1);r.reject(null)}}).fail(function(n){var i=["Browser check failure: ",n.status,n.statusText,];t.logError(i.join(", "),f);r.reject(null)}),r.promise()):o},getAPIToken:function(i){var r=this,f="/services/auth/getaccesstoken",u=n.Deferred(),e=r.getStoredAPIToken();return e===null||i===!0?(n.ajax({url:f,type:"GET",dataType:"JSON",cache:!1}).done(function(n){n.Success===!0&&n.Model?r.storeAPIToken(n.Model):r.storeAPIToken(null);u.resolve(r.getStoredAPIToken())}).fail(function(n){var i=[n.status,n.statusText,];t.logError(i.join(", "),f);u.reject(null)}),u.promise()):e},storeBrowserSupport:function(n,t){window.sessionStorage&&n&&sessionStorage.setItem(this.cachedBrowserSupportKey+n,t)},getStoredBrowserSupport:function(n){return window.sessionStorage&&n?sessionStorage.getItem(this.cachedBrowserSupportKey+n)==="true":null},storeAPIToken:function(n){window.sessionStorage&&sessionStorage.setItem(this.cachedAPITokenKey,n)},getStoredAPIToken:function(){return window.sessionStorage?sessionStorage.getItem(this.cachedAPITokenKey):null}};return{getBrowserSupport:function(n){return u.getBrowserSupport(n)},getJSON:function(f,e,o,s){var h=!0,c;s===!0&&(c=i.getUrlObject(f.action),h=u.getBrowserSupport(c.hostname));n.when(h).then(function(){var i=function(n){if(n!==null)return f.headers={Authorization:"Bearer "+n},t.getJSON(f,e,o)};n.when(u.getAPIToken()).then(function(t){var r=i(t);r&&r.fail(function(t){t.status===401&&n.when(u.getAPIToken(!0)).then(function(n){i(n)})})}).fail(function(){typeof o=="function"&&o({statusCode:-1,textStatus:"systemError",errorThrown:"Token is invalid"})})}).fail(function(){n.fn.wyzantModal("showWyzantModal",{content:"<div class='modal-medium'>    <h3>We take privacy seriously!<\/h3>    <p>We&rsquo;ve noticed that your browser is out of date and may not comply with current security standards.    In order to ensure your payment information remains secure, please update your browser.<\/p><\/div>"});r.trackEvent("AJAX API call","error","Unsupported_browser");typeof o=="function"&&o({statusCode:-1,textStatus:"systemError",errorThrown:"Browser not supported"})})},mapErrorMessagesToFields:function(n,t,i){var u={},f=[],o,r,s,e;for(o in n)if(r=n[o],"InvalidFields"in r&&"ReasonInvalid"in r)for(s in r.InvalidFields)e=r.InvalidFields[s].FieldName,e in t?u[t[e]]=r.ReasonInvalid:f.push(r.ReasonInvalid);return i&&f.length>0&&(u.unknown=f),u}}});define("AppContextUtils",["moment","momentTimezone",],function(n){window.moment=n;var t=window.wyzant&&window.wyzant.appContext;if(!t){console.error("You must include the JavascriptAppContext to use AppContextUtils.");return}return{setContext:function(n){t.setContext(n)},getContext:function(){return t.getContext()},setTimeZone:function(n){t.setTimeZone(n)},convertUtcToUserTimeZone:function(n,i){return t.convertUtcToUserTimeZone(n,i)},convertUserTimeZoneToUtc:function(n,i){return t.convertUserTimeZoneToUtc(n,i)},getUtcOffsetInHours:function(){return t.getUtcOffsetInHours()}}});define("AsyncUtils",["jquery","AjaxUtils","MustacheUtils",],function(n,t,i){var r={unloadedTemplates:{nodes:null,templates:{}},cachedData:{},templateIDAttribute:"data-templateID",responsiveLoading:!1,disableCaching:!1,loadUnloadedTemplates:function(){var t=this;this.unloadedTemplates.nodes.filter(":visible").each(function(){var i=this.getAttribute(t.templateIDAttribute);t.disableCaching===!0?u.loadTemplateData(this,t.unloadedTemplates.templates[i],n("#"+i).html()):u.loadTemplateDataWithCache(this,t.unloadedTemplates.templates[i],n("#"+i).html())})},updateUnloadedTemplates:function(){this.unloadedTemplates.nodes=this.unloadedTemplates.nodes.not(":visible");this.unloadedTemplates.nodes.length===0&&(n(window).off("resize orientationchange repaintTemplates",f),responsiveLoading=!1)},initResponsiveLoading:function(){if(this.responsiveLoading===!1){this.responsiveLoading=!0;n(window).on("resize orientationchange repaintTemplates",f)}}},f=function(){r.loadUnloadedTemplates();r.updateUnloadedTemplates()},u={populateAsyncTemplates:function(t,i,u,f){var e,o,s=this;r.disableCaching=f;t=t.filter("["+r.templateIDAttribute+"]");e=t;u===!0&&(o=t.not(":visible"),n.extend(r.unloadedTemplates.templates,i),r.unloadedTemplates.nodes instanceof jQuery?r.unloadedTemplates.nodes.add(o):r.unloadedTemplates.nodes=o,e=t.filter(":visible"),r.initResponsiveLoading());e.each(function(){var t=this.getAttribute(r.templateIDAttribute);f!==!0?s.loadTemplateDataWithCache(this,i[t],n("#"+t).html()):s.loadTemplateData(this,i[t],n("#"+t).html())})},loadTemplateData:function(r,u,f){var e=n(r);typeof u!="undefined"&&typeof u.url!="undefined"&&(e.trigger("loadingTemplateData"),t.getJSON({action:u.url,method:"GET",data:""},function(n){e.html(i.renderTemplateHTML(n.Model,f,u.parser));e.trigger("loadTemplateDataComplete")},function(){e.trigger("loadTemplateDataFailed")}))},loadTemplateDataWithCache:function(u,f,e){var o=n(u);typeof f!="undefined"&&typeof f.url!="undefined"&&(o.trigger("loadingTemplateData"),typeof r.cachedData[f.url]=="undefined"&&(r.cachedData[f.url]={templates:[],data:null}),r.cachedData[f.url].data!==null?(o.html(i.renderTemplateHTML(r.cachedData[f.url].data,e,f.parser)),o.trigger("loadTemplateDataComplete")):(r.cachedData[f.url].templates.push({$el:o,template:e,parser:f.parser}),r.cachedData[f.url].templates.length===1&&t.getJSON({action:f.url,method:"GET",data:""},function(n){var t=r.cachedData[f.url],u=t.templates.length;for(t.data=n.Model;u--;)t.templates[u].$el.html(i.renderTemplateHTML(n.Model,t.templates[u].template,t.templates[u].parser)),t.templates[u].$el.trigger("loadTemplateDataComplete")},function(){for(var n=r.cachedData[f.url],t=n.templates.length;t--;)n.templates[t].$el.trigger("loadTemplateDataFailed")})))},loadAsyncScript:function(n,t,i){var r;if(n=n.css({height:"10px"}).filter(":visible"),n.length>0)r=document.createElement("script"),typeof i=="function"&&(r.onload=function(){i()}),r.src=t,document.body.appendChild(r);else return!1;n.css({height:""})}};return u});define("Base",["jquery",],function(n){return{els:{},$els:{},addEls:function(t){var i=this;n.extend(this.els,t);document.readyState!=="loading"?this.cacheEls():(this.preventCacheErrors(),document.addEventListener("readystatechange",function(){document.readyState!=="loading"&&i.cacheEls()},!1))},cacheEls:function(){var t;typeof this.$els!="object"&&(this.$els={});for(t in this.els)this.$els[t]=n(this.els[t]);this.els={}},preventCacheErrors:function(){var t;for(t in this.els)this.$els[t]=n()}}});define("MustacheUtils",["jquery","mustache",],function(n,t){return{templates:{},templateHTML:{},addTemplates:function(t){var i=this;n.extend(this.templates,t);document.readyState!=="loading"?this.parseTemplates():document.addEventListener("readystatechange",function(){document.readyState!=="loading"&&i.parseTemplates()},!1)},parseTemplates:function(){var i;for(i in this.templates)this.templateHTML[i]=n(this.templates[i]).html(),t.parse(this.templateHTML[i]);this.templates={}},renderTemplateHTML:function(n,i,r){return typeof n=="undefined"||n===null?"":(typeof r=="function"&&(n=r(n)),t.render(i,n))}}});define("Tracking",function(){var t={category:"wyzant",action:"click"},n=function(n,t,i,r,u){window.ga&&ga("send",{hitType:n,eventCategory:t,eventAction:i,eventLabel:r,eventValue:u})},i=function(i,r){if(i&&i.length>0){var u=$.extend(t,r),f=u.action.toLowerCase();i.on(f,function(t){var i=$(this),r=i.attr("data-trackingCategory")||u.category,f=i.attr("data-trackingAction")||t.type,e=i.attr("data-trackingLabel")||u.label||i.text()||i.attr("id"),o=i.attr("data-trackingValue")||u.value;n("event",r,f,e,o)})}},r=function(t,i,r,u){t&&i&&n("event",t,i,r,u)};return{trackElements:i,trackEvent:r}});define("Utils",function(){var n={getUrlObject:function(n){if(n===""||n===null)return{};var t=window.location;return n&&(t=document.createElement("a"),t.href=n),{protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,pathname:t.pathname,hash:t.hash,search:t.search}},getUrlParamsObject:function(n,t){var u,r,i,h;if(n===""||n===null)return{};n=n||window.location.search;var f=$.extend({convertToPrimitives:!1,decodeValues:!0,convertKeyToLowerCase:!1},t),e={},o=n.replace("?","").split("&"),s=o.length;if(s>0)for(u=0;u<s;u++)r=o[u].split("="),r.length>=1&&(i=r[1]||null,i!==null&&(f.decodeValues&&(i=decodeURIComponent(i).replace(/\+/g," ")),f.convertToPrimitives&&(i.match(/^(true|false)$/i)?i=i.toLowerCase()==="true":i.match(/^\d+$/)?i=parseInt(i,10):i.match(/^\d+\.\d+$/)&&(i=parseFloat(i)))),h=f.convertKeyToLowerCase?r[0].toLowerCase():r[0],e[h]=i);return e}};return{getUrlObject:function(t){return n.getUrlObject(t)},getUrlObjectWithParams:function(t,i){var r=n.getUrlObject(t);return r.parameters=n.getUrlParamsObject(r.search,i),r},getUrlParams:function(t,i){var r=n.getUrlObject(t);return n.getUrlParamsObject(r.search||null,i)},getUrlParamValue:function(t,i,r){var u=n.getUrlParamsObject(i,r);return t in u?u[t]:null},convertToFriendlyFileSize:function(n){var t=Math.floor(Math.log(n)/Math.log(1024));return(n/Math.pow(1024,t)).toFixed(2)*1+" "+["b","Kb","Mb","Gb","Tb",][t]},getRandomNumber:function(n,t){return Math.floor(Math.random()*(t-n+1))+n}}})